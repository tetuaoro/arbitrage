"use strict";var r=this&&this.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};exports.__esModule=!0,exports.getRouterContractFromPairAddress=exports.getNameExchange=exports.ROUTERS=exports.FACTORIES=exports.EXCHANGE_INFOS=exports.required=exports.eqAddress=exports.getToken=exports.switchInfuraProvider=exports.raoContract=exports.tokenContract=exports.pairContract=exports.routerContract=exports.factoryContract=exports.signer=exports.provider=exports.NETWORK=exports.THROW_NOT_FOUND_TOKEN=exports.THROW_NOT_FOUND_PAIR=exports.isDevelopment=void 0;var e=require("dotenv"),t=require("ethers"),o=require("./abi/IUniswapV2Factory.json"),s=require("./abi/IUniswapV2Router01.json"),p=require("./abi/IUniswapV2Pair.json"),n=require("./abi/IERC20.json"),a=require("./abi/RaoArbitrage.json"),i=r(require("./tokens.json"));(0,e.config)(),exports.isDevelopment="dev"==process.env.NODE_ENV,exports.THROW_NOT_FOUND_PAIR="THROW_NOT_FOUND_PAIR",exports.THROW_NOT_FOUND_TOKEN="THROW_NOT_FOUND_TOKEN",exports.NETWORK=137;var c=process.env.INFURA_IDS.split(","),x=process.env.INFURA_SECRETS.split(","),d=0;exports.provider=exports.isDevelopment?new t.providers.JsonRpcProvider("http://localhost:8545",exports.NETWORK):new t.providers.InfuraProvider(exports.NETWORK,{projectId:c[d],projectSecret:x[d]}),exports.signer=new t.Wallet(exports.isDevelopment?process.env.GANACHE_PRIVATE_KEY:process.env.PRIVATE_KEY,exports.provider),exports.factoryContract=new t.Contract(t.constants.AddressZero,o.abi,exports.provider),exports.routerContract=new t.Contract(t.constants.AddressZero,s.abi,exports.provider),exports.pairContract=new t.Contract(t.constants.AddressZero,p.abi,exports.provider),exports.tokenContract=new t.Contract(t.constants.AddressZero,n.abi,exports.provider),exports.raoContract=new t.Contract("0x4c2fC697B1C0d571E04C6F2750c672BE0CB66407",a.abi,exports.provider);exports.switchInfuraProvider=function(){exports.provider.removeAllListeners(),d=(d+1)%x.length;var r={projectId:c[d],projectSecret:x[d]};exports.provider=new t.providers.InfuraProvider(exports.NETWORK,r),exports.signer=exports.signer.connect(exports.provider),exports.factoryContract=exports.factoryContract.connect(exports.provider),exports.routerContract=exports.routerContract.connect(exports.provider),exports.pairContract=exports.pairContract.connect(exports.provider),exports.tokenContract=exports.tokenContract.connect(exports.provider),exports.raoContract=exports.raoContract.connect(exports.provider);for(var e=0,o=exports.EXCHANGE_INFOS;e<o.length;e++){var s=o[e];exports.FACTORIES.shift(),exports.ROUTERS.shift();for(var p=s.pairs.length,n=0;n<p;n++)s.pairs.pop();exports.FACTORIES.push(exports.factoryContract.attach(s.factory)),exports.ROUTERS.push(exports.routerContract.attach(s.router))}};exports.getToken=function(r){var e=i.default.find((function(e){return e.symbol==r}));if(void 0===e)throw new Error(exports.THROW_NOT_FOUND_TOKEN);return e};exports.eqAddress=function(r,e){return t.utils.isAddress(r)&&t.utils.isAddress(e)&&t.BigNumber.from(r).eq(t.BigNumber.from(e))};exports.required=function(r,e){if(!r)throw new Error(e||"Required: Une erreur est survenue !")},exports.EXCHANGE_INFOS=[{name:"Sushiswap",factory:"0xc35DADB65012eC5796536bD9864eD8773aBc74C4",router:"0x1b02dA8Cb0d097eB8D57A175b88c7D8b47997506",pairs:[]},{name:"Quickswap",factory:"0x5757371414417b8C6CAad45bAeF941aBc7d3Ab32",router:"0xa5E0829CaCEd8fFDD4De3c43696c57F7D7A678ff",pairs:[]},{name:"Apeswap",factory:"0xCf083Be4164828f00cAE704EC15a36D711491284",router:"0xC0788A3aD43d79aa53B09c2EaCc313A787d1d607",pairs:[]},{name:"Jetswap",factory:"0x668ad0ed2622C62E24f0d5ab6B6Ac1b9D2cD4AC7",router:"0x5C6EC38fb0e2609672BDf628B1fD605A523E5923",pairs:[]}],exports.FACTORIES=exports.EXCHANGE_INFOS.map((function(r){return exports.factoryContract.attach(r.factory)})),exports.ROUTERS=exports.EXCHANGE_INFOS.map((function(r){return exports.routerContract.attach(r.router)}));exports.getNameExchange=function(r){for(var e=0,t=exports.EXCHANGE_INFOS;e<t.length;e++){var o=t[e];if((0,exports.eqAddress)(o.factory,r)||(0,exports.eqAddress)(o.router,r)||void 0!==o.pairs.find((function(e){return(0,exports.eqAddress)(e,r)})))return o.name}};exports.getRouterContractFromPairAddress=function(r){for(var e=0,t=0,o=exports.EXCHANGE_INFOS;t<o.length;t++){if(void 0!==o[t].pairs.find((function(e){return(0,exports.eqAddress)(e,r)})))return exports.ROUTERS[e];e++}},process.on("exit",(function(){console.log("purge utils script"),exports.provider.removeAllListeners()}));